# Web API Endpoints Documentation

## 1. Login/Register

Endpoints for users register and log in.

### Database Schemas

The resources for both user's registration and user's log in

#### Users
| Field    | Data Type        | Metadata                                            |
| -------- | -----------------| --------------------------------------------------- |
| id       | unsigned integer | primary key, auto-increments, generated by database |
| username | string           | required, unique, max 128 characters                |
| password | string           | required                                            |

### Register

#### Endpoint

```sh
POST /api/auth/register
URL: https://build-week-expat-journal-1.herokuapp.com/api/auth/register
```

#### Request Body

request object:
```sh
{ 
  username: string(128),
  password: string
}
```

#### Response (Success)

statusCode: 200
response object:
```sh
{ 
  status: 'success',
  message: `Registered Successfully. Welcome, ${username}.`
}
```

### Login

#### Endpoint

```sh
POST /api/auth/login
URL: https://build-week-expat-journal-1.herokuapp.com/api/auth/login
```

#### Request Body

request object:
```sh
{ 
  username: string(128),
  password: string(255)
}
```

#### Response (Success)

statusCode: 200
response object:
```sh
{ 
  status: 'success',
  message: `Welcome, ${username}.`,
  token
}
```

## 2. CRUD Stories and Photos

Endpoints for a user creates, reads, updates and deletes his/her stories and photos

### Database Schemas

The resources for CRUD stories and photos

#### Stories
| Field     | Data Type        | Metadata                                             |
| --------- | -----------------| ---------------------------------------------------- |
| id        | unsigned integer | primary key, auto-increments, generated by database  |
| title     | string           | required, max length of 255 characters               |
| teaser    | string           | required, max length of 255 characters               |
| content   | text             | required, holding a string of 65,535 bytes           |
| user_id   | unsigned integer | required, foreign key, ref: 'id' from 'users' table  |

#### Photos
| Field     | Data Type        | Metadata                                             |
| --------- | -----------------| ---------------------------------------------------- |
| id        | unsigned integer | primary key, auto-increments, generated by database  |
| image_url | text             | required, unique, holding a string of 65,535 bytes   |
| desc      | text             | required, holding a string of 65,535 bytes           | 
| story_id  | unsigned integer | required, foreign key, ref: 'id' from 'stories table |

### Create a Story

#### Endpoint

```sh
POST /api/stories
URL: https://build-week-expat-journal-1.herokuapp.com/api/stories
```

#### Request Body

request object:
```sh
{ 
  title: string 225,
  teaser: string 255,
  content: text,
  user_id: unsigned integer,
  photos: [
    { 
      image_url: string,
      desc: string,
      story_id: unsigned integer
    }
    ...
  ]
}
```
'photos' object is optional.

#### Response (Success)

statusCode: 201
response object:
```sh
{ 
  "status": "success",
  "story": [
    id
  ]
}
```
'id' is the id of the story just created.

### Read Stories

#### Endpoint

```sh
GET /api/stories
URL: https://build-week-expat-journal-1.herokuapp.com/api/stories
```

#### Request Body

request object: None

#### Response (Success)

statusCode: 201
response object sample:
```sh
{
  "status": "success",
  "stories": [
    {
      "id": 6,
      "title": "The Journal Title",
      "teaser": "It’s been smoky here lately...",
      "content": "Content of the stories is here.",
      "user_id": 1,
      "photos": [
        {
          "id": 9,
          "image_url": "https://build-week-expat-journal-01.com/01.jpg",
          "desc": "picture 01",
          "story_id": 6
        },
        {
          "id": 10,
          "image_url": "https://build-week-expat-journal-01.com/02.jpg",
          "desc": "picture 02",
          "story_id": 6
        }
      ]
    },
    ...
  ]
}
```

### Read a Story By Id

#### Endpoint

```sh
GET /api/stories/:id
URL: https://build-week-expat-journal-1.herokuapp.com/api/stories/:id
```
':id' is story id

#### Request Body

request object: None

#### Response (Success)

statusCode: 201
response object sample:
```sh
{
  "status": "success",
  "story": {
    "id": 6,
    "title": "The Journal Title",
    "teaser": "It’s been smoky here lately...",
    "content": "Content of the stories is here.",
    "user_id": 1,
    "photos": [
      {
        "id": 9,
        "image_url": "https://build-week-expat-journal-01.com/01.jpg",
        "desc": "picture 01",
        "story_id": 6
      },
      {
        "id": 10,
        "image_url": "https://build-week-expat-journal-01.com/02.jpg",
        "desc": "picture 02",
        "story_id": 6
      }
    ]
  }
```

### Update a Story By Id

#### Endpoint

```sh
PUT /api/stories/:id
URL: https://build-week-expat-journal-1.herokuapp.com/api/stories/:id
```
':id' is story id

#### Request Body

request object:
```sh
{ 
  "title": sting,
  "teaser": sting,
  "content": text,
  "user_id": unsigned integer
}
```

#### Response (Success)

statusCode: 200
response object sample:
```sh
{
  "status": "success",
  "story": {
    "id": 6,
    "title": "The Journal Title Updated",
    "teaser": "It’s been smoky here lately...",
    "content": "Content of the stories is here.",
    "user_id": 1
  }
}
```

### Delete a Story By Id

#### Endpoint

```sh
DELETE /api/stories/:id
URL: https://build-week-expat-journal-1.herokuapp.com/api/stories/:id
```
':id' is story id

#### Request Body

request object:
```sh
{ 
  "title": sting,
  "teaser": sting,
  "content": text,
  "user_id": unsigned integer
}
```

#### Response (Success)

statusCode: 200
response object sample:
```sh
{
  "status": "success",
  "message": "The story and its photos have been deleled."
}
```
